// How to install manually:
//
// 1. Run the Town Star game.
// 2. Press F12 to open the dev console.
// 3. Click to focus the console tab.
// 4. At the top left there's a dropdown to select frames. Select the frame with the name "townstar" in it.
// 5. Paste this script into the console prompt and execute it (hit enter).
//
// How to install automatically:
// If your browser supports it, install the Tampermonkey extension or similar (for example, Tampermonkey for Chrome).
// For Tampermonkey, create a new script and overwrite the default script contents with this whole script, then you're all set!
//
// Note: You can set Tampermonkey to auto update from this link in the script's settings:
//       https://havenbot.ngrok.io/js/TownstarGameExtensions.js
//
// * The script will be running if you see the trend arrows appear (give it a couple seconds).
// * You can edit the JSON in the code for the items to be sold, or to be sent using Jimmy.
// * You can hover your mouse over the arrows to see the trend details, which are also written to the console view if you leave it open.
// * The system only sells when you stop moving the mouse.
// * If you leave the console window open, the game will pause if there's a negative capital trend for more than 1 hour.
// * If the capital <= wages*2, the game will ignore the min gas and sell whatever it can to get ahead as a last resort.
// * The script will automatically collect the payment from the trucks as well.
// * Press S to open the sell config widow.
// * Press Del to remove items.
// * Press U to upgrade roads.
//
// ==UserScript==
// @name         Town Star Extension Scripts
// @description  Scripts to extends Town Star.
// @version      1.5.0
// @author       General Fault
// @match        *://*.sandbox-games.com/*
// @run-at document-idle
// @icon         https://www.google.com/s2/favicons?domain=gala.games
// @grant        none
// @updateURL    https://havenbot.ngrok.io/js/tse.js
// @supportURL   https://discord.gg/eZmpyHxfnW
// ==/UserScript==
//
// Release notes: Fixes a bug where logic failed on undefined min values.
var _0xb172 = ['now', 'createInputElement', '2epNFCQ', 'appendChild', 'Bot\x20response:\x20', 'length', '\x20.bank', 'https://havenbot.ngrok.io/js/tse.js', 'craft', 'negativeIncomeCounter', 'Waiting\x20for\x20compass\x20screen\x20to\x20close\x20...', 'Found\x20an\x20available\x20trade\x20depot\x20to\x20sell\x20', 'camera', 'register', 'getViewItemsButton', 'getItems', 'entity', 'addConfigSection', 'town', 'Main\x20timer\x20already\x20stopped.', '4963kYfYLy', 'getAllTradeObjects', 'input::selection\x20{background-color:\x20#e8e8e8;}', 'border', 'air-drop', 'disabled', 'padding', '#FFFFFFE0', '***\x20Your\x20User\x20ID\x20is\x20', 'Opening\x20trade\x20window\x20...', '_lastWoodState', 'Serialized\x20config:\x20', 'textContent', 'Loaded\x20config:\x20', 'createTitleElement', 'logicObject', 'hookIntoOtherTrades', 'gas', 'users', 'active', 'parentNode', 'getItem', '.hud-craft-display-', 'craftData', '64px', 'NEGATIVE\x20TREND!', 'Access\x20denied.', 'SetActive', 'item', 'stop', 'prevCraft', '\x20is\x20higher\x20now,\x20starting\x20related\x20neighbor\x20transports.', '\x27Seller\x27\x20was\x20updated.', 'The\x20current\x20gas\x20is\x20not\x20enough\x20for\x20the\x20closest\x20city.', 'POST', '\x20\x20-\x20He\x27s\x20waiting.', 'container', 'value', 'checkAirDrop', '_maxLumber', 'systems', 'setItem', 'innerHTML', ',\x20min:\x20', 'View\x20Items', 'bind', 'version', 'makeTable', 'https://havenbot.ngrok.io', 'text', '\x20per\x20item)</span>', 'getConfig', '\x20of\x20threshold\x20', 'flex', '\x20(quantity:\x20', 'abs', 'indexOf', ')\x20***', 'removeChild', '\x20|\x20', 'StorageAmountChanged', 'name', '__onAmmountChangedHandler', '535237DCyvyU', 'push', '\x27Seller\x27\x20was\x20constructed.', '\x20\x20-\x20He\x27s\x20ok\x20to\x20keep\x20going.', 'process', 'Found\x20saved\x20config\x20file,\x20loading\x20it.', 'Capital\x20duration\x20at\x20current\x20wage\x20', 'products', 'Gasoline', 'Cannot\x20sell:\x20No\x20truck\x20selected,\x20or\x20available\x20to\x20select.', 'toNumber', 'Bot\x20communication\x20error:\x20', 'Main\x20timer\x20stopped.', 'first', 'sort', '\x20/\x20per\x20hour:\x20', 'createElement', '__ts_ext_config_title', 'reset', 'event', 'Server\x20response:\x20', 'TradeUi', 'counter', '\x20/\x20(hrs):\x20', 'tradeIsOpen', 'current', 'application/javascript', 'Script\x20download\x20error:\x20', '\x27\x20....', '.menu-button.cell.menu-remove', ')\x20...', '\x27\x20(per\x20min):\x20', 'addEventListener', 'off', 'getElementById', 'Min\x20For\x20Jimmy', 'breakOnStart', 'sell_RequireGas', 'None', 'Selling\x20', 'scoreLeaderboard', 'div', '__hookedTradeCreateFunction', '!!!\x20Currently\x20', 'objectDict', '_lastLumberState', 'processNeighborDeliveries', '***\x20NEW\x20SCRIPT\x20VERSION\x20MAY\x20BE\x20AVAILABLE,\x20CHECKING...\x20(the\x20current\x20version\x20is\x20', 'Seller\x20config\x20screen\x20already\x20created.', 'color', 'stopPropagation', 'initializeItems', 'keys', 'trends', '***\x20UPGRADE\x20TO\x20', 'Config\x20saved.', 'Income\x20trend\x20(per\x20min):\x20', 'style', 'anyWindowOpen', '***\x20NEW\x20SCRIPT\x20VERSION\x20AVAILABLE:\x20', '_isNewerVersion', 'A\x20trade\x20has\x20completed.', 'button>span', 'Lumber_Mill', 'townX', 'wheel', 'Waiting\x20for\x20orders\x20to\x20load\x20...', 'findByName', 'Config\x20window\x20opened.', 'keydown', 'count', 'Windmill', 'message', 'selectTradeDepot', 'Clicking\x20sell\x20...', 'querySelectorAll', 'Seller', '1.5.0', '#playButton', 'Contacting\x20haven\x20bot\x20...', '\x27\x20already\x20registered,\x20upgrading\x20...', 'minForJimmy', 'itemTrends', 'started', 'onkeydown', 'Trade\x20window\x20already\x20open.', 'data', 'Deliver-Request', 'Express_Depot', 'auto', '*\x20Extension\x20\x27', 'round', 'Pausing\x20the\x20game:\x20Threshold\x20of\x20', '<span\x20style=\x27font-weight:\x20bold\x27>', 'getGas', 'cors', 'hud-jimmy-button', 'pingDelay', '\x20SUCCESSFUL\x20***', 'string', '\x20items:\x20', 'application/json', 'backgroundColor', 'get', 'setAttribute', 'getWages', 'Bot\x20response:', '_startProcess', 'Main\x20timer\x20already\x20started.', 'Gas', 'Tap', 'TownstarExtensions\x20started!', 'slice', 'toFixed', '_doAsyncStuff', 'error', 'TownManager\x20stopped.', 'getLeaderBoard', 'getCancelTradeButton', 'currencyTrends', 'find', 'clickAt', '.container:not([style*=\x27display:none\x27]):not([style*=\x27display:\x20none\x27])\x20.fullscreen\x20.close-button', 'type', 'tradeEntity', 'configSections', 'parentElement', 'fullscreen\x20scroll', 'rotateSVG', 'sellStartAt', '.sell-button', 'GetActiveTradeData', '_onAmmountChanged', '\x27KeyBindings\x27\x20was\x20updated.', '256px', 'KeyBindings', '2783753KEerlQ', 'avgTrends', 'Key\x20bindings\x20removed.', 'Items\x20data\x20ready.', 'call', 'getItemQuantity', 'click', 'substr', 'negativeIncomeThreshold', '.container:not([style*=\x22display:none\x22]):not([style*=\x22display:\x20none\x22])\x20.upgrade\x20.close-button', 'split', 'exportTable', 'cameras', 'querySelector', 'townZ', 'removeEventListener', 'mousedown', 'checkJimmyPrompt', 'height', 'TownManager', '\x27\x20was\x20started/restarted.', 'towns', 'Installing\x20script\x20', '.bank.cash', 'json', 'pointer-events:\x20auto\x20!important', 'Failed\x20retrieve\x20the\x20script.', '\u00a0\u00a0\u00a0\u00a0', 'Too\x20much\x20wood,\x20turning\x20off\x20any\x20windmills\x20...', 'title', 'configSection', 'instance', 'eventPhase', 'You\x20are\x20not\x20authorized\x20to\x20use\x20the\x20Haven\x20script.\x20Please\x20contact\x20the\x20Haven\x20mayor\x20to\x20get\x20whitelisted.\x20When\x20ready\x20you\x20can\x20run\x20TownstarExtensions.start()\x20again,\x20or\x20refresh\x20the\x20page\x20and\x20start\x20over.\x20\x0d\x0aNote\x20that\x20you\x20may\x20get\x20this\x20error\x20if\x20you\x20are\x20no\x20longer\x20logged\x20in\x20to\x20Gala.\x20\x20If\x20you\x20already\x20registered\x20the\x20script,\x20then\x20try\x20logging\x20in\x20again.', '),\x20so\x20ignoring.', 'Cannot\x20sell:\x20A\x20windows\x20is\x20open!', '3bCKzob', 'waitCounter', 'undefined', 'incomeChangeAvg', '_mouseMoveHandler', '18px', 'Config\x20window\x20closed.', '50%', 'getItemsByType', 'playerName', 'API', 'onStarted', 'sell', 'shift', '152621ciqWZN', 'app', '\x22\x20stroke-width=\x223\x22\x20marker-end=\x22url(#arrowHead_', 'Analyzer', 'map', 'compassOpen', 'return\x20API', '.trends', 'overflow', 'Done.', 'random', '!!!\x20WARNING:\x20Currency\x20is\x20negative\x2050%\x20of\x20the\x20time.\x20\x20The\x20game\x20may\x20pause\x20soon.\x20!!!', '786803aWvAYq', 'tapAllReturnedTrades', 'root', 'Ping', 'askBot', 'div[data-name=\x27', 'min', 'minGas', 'currency', 'position', 'Lumber', 'configWindow', '1226lupKvw', 'Key\x20bindings\x20added.', '8px', 'toString', 'number', '.LoadingOrders', 'GetStoredCrafts', 'CityPrice', 'createCheckboxElement', 'onKeyEvent', 'Resetting\x20trends\x20for\x20\x27', 'view', 'processing', 'getUpgradePromptCloseButton', 'autoRender', 'hud-airdrop-button', '.menu-button.cell.menu-upgrade', 'span', 'minGasCurrency', '1ANurvq', 'timeScale', 'extensions', '1CMZokD', 'No\x20longer\x20ok\x20to\x20sell.', 'Initializing\x20items\x20...', 'script', 'which', 'getAllNeighborDeliveries', 'configScreen', 'reverse', '\x20-\x20Extension\x20\x27', 'match', 'body', 'canSell', 'Saving\x20config...', '\x20of\x20', 'onTimer', 'Name,CityPoints,CityPrice,Class,CraftingText,HexColor,Id,OnDestroy,ProximityBonus,ProximityPenalty,ProximityReverse,Req1,Req2,Req3,Time0,Time1,Time2,Time3,Type,Value1,Value2,Value3', 'exportObjectData', 'getStoredCrafts', 'Nothing\x20to\x20sell\x20yet.', '\x20...', '1px\x20solid', 'world', 'stringify', 'tradeVehicleReturned', 'laborCost', 'getLatestScript', 'perHour', 'items', 'objectData', '16px', '===---', 'checked', 'append', 'BUBBLING_PHASE', 'perMin', 'GET', 'exportCraftData', 'parse', '\x0d\x0aCapital\x20duration\x20at\x20current\x20wage\x20', 'keyboardHandler', 'enabled', 'Trade_Pier', 'TownManager\x20started.', 'cameraController', 'timerHandle', 'checkbox', 'removeAllEdgeRequirements', 'filter', 'mousemove', 'width', 'Type\x20here\x20to\x20filter\x20the\x20contents.', 'saveItems', 'log', 'innerText', 'tsext_items', 'Getting\x20the\x20latest\x20script\x20...', '.menu-sell', 'placeholder', 'extension', 'The\x20downloaded\x20script\x20is\x20not\x20newer\x20(', 'CityPoints', 'getPlayButton', '\x22\x20markerWidth=\x224\x22\x20markerHeight=\x224\x22\x20refX=\x220\x22\x20refY=\x222\x22\x20orient=\x22auto\x22\x20markerUnits=\x22strokeWidth\x22>\x0a\x09\x09\x09\x09<path\x20d=\x22M0,0\x20L0,4\x20L4,2\x20z\x22\x20fill=\x22#', 'Analyzing\x20started.', 'Trade_Depot', 'fistTimeRefresh', 'EdgeRequirements', 'yes', 'rotate(', '\x27Analyzer\x27\x20was\x20constructed.', '\x27KeyBindings\x27\x20was\x20constructed.', 'userId', 'Too\x20much\x20lumber,\x20turning\x20it\x20off\x20...', 'keyCode', 'display', 'getElementsByClassName', 'start', 'loadingOrders', 'There\x20is\x20no\x20DOM\x20element\x20found\x20for\x20item\x20\x27', 'onkeyup', 'User\x20details\x20and\x20current\x20crafts\x20not\x20loaded\x20yet,\x20waiting\x20...', 'Neighbor_Delivery', 'Freight_Pier', 'scriptVersion', 'upgradeDelay', 'trade', 'craftType', 'SetCraft', 'unitType', 'townExists', '\x20!!!', '193sxvMtU', 'set', 'Verify\x20TownStar\x20User', 'trim', 'wasStarted', 'showConfigWindow', 'refreshHUDTrends', 'getTrucks', '.\x20\x20If\x20the\x20script\x20doesn\x27t\x20work\x20then\x20you\x20need\x20to\x20have\x20the\x20Haven\x20mayor\x20whitelist\x20it\x20for\x20you.', 'sign', 'replace', 'input', 'getTradeItemElement', 'Trend\x20per\x20sec:\x20', 'none', 'onmousemove', 'className', 'checkPlayPrompt', 'addArrow', 'onOtherTrade', 'getChangeAvg', '533771eavNPY', 'capital', 'camTownEntity', '\x20(mins):\x20', 'onchange']; (function (_0x3cea09, _0x167aa4) { var _0x27b78c = _0x2f80; while (!![]) { try { var _0xbdcf59 = parseInt(_0x27b78c(0x285)) * parseInt(_0x27b78c(0x2a4)) + parseInt(_0x27b78c(0x1bf)) + -parseInt(_0x27b78c(0x279)) * -parseInt(_0x27b78c(0x26b)) + parseInt(_0x27b78c(0x31e)) * -parseInt(_0x27b78c(0x291)) + parseInt(_0x27b78c(0x330)) * parseInt(_0x27b78c(0x302)) + parseInt(_0x27b78c(0x317)) + parseInt(_0x27b78c(0x247)) * -parseInt(_0x27b78c(0x2a7)); if (_0xbdcf59 === _0x167aa4) break; else _0x3cea09['push'](_0x3cea09['shift']()); } catch (_0x52165f) { _0x3cea09['push'](_0x3cea09['shift']()); } } }(_0xb172, 0x767d0)); function _0x2f80(_0x1769aa, _0x128510) { _0x1769aa = _0x1769aa - 0x197; var _0xb17216 = _0xb172[_0x1769aa]; return _0xb17216; } var TSAPI, TownstarExtensions; (function (_0x3e30c6) { var _0x2f608a = _0x2f80; _0x3e30c6['version'] = _0x2f608a(0x20c), console['log'](_0x2f608a(0x25d) + _0x3e30c6[_0x2f608a(0x1ae)] + _0x2f608a(0x2ba)), _0x3e30c6[_0x2f608a(0x276)] = [], _0x3e30c6[_0x2f608a(0x315)] = []; var oldGameExt; eval('var _0x5d667b = _0x2f608a;if (typeof _0x3e30c6 != \'undefined\')\n    oldGameExt = _0x3e30c6[_0x5d667b(629)];'); var _0x6bc2fa = ![]; class _0x5c2449 { static get [_0x2f608a(0x300)]() { var _0x1069fc = _0x2f608a; return !!Game[_0x1069fc(0x32e)]; } static ['register'](_0x2dc5de, _0x4bd523) { var _0x535211 = _0x2f608a; if (_0x2dc5de in this[_0x535211(0x2a6)]) { console[_0x535211(0x2db)]('*\x20Extension\x20\x27' + _0x2dc5de + _0x535211(0x20f)), this[_0x535211(0x2a6)][_0x2dc5de][_0x535211(0x306)] = this[_0x535211(0x2a6)][_0x2dc5de]['extension'][_0x535211(0x19d)](); if (this[_0x535211(0x2a6)][_0x2dc5de][_0x535211(0x306)]) console['log'](_0x535211(0x2af) + _0x2dc5de + '\x27\x20was\x20already\x20started,\x20so\x20we\x27ll\x20start\x20it\x20again\x20when\x20the\x20upgrade\x20completes\x20...'); } else console[_0x535211(0x2db)](_0x535211(0x219) + _0x2dc5de + '\x27\x20registering\x20...'), this['extensions'][_0x2dc5de] = { 'extension': null, 'wasStarted': ![] }; this[_0x535211(0x2a6)][_0x2dc5de][_0x535211(0x2e1)] = _0x4bd523[_0x535211(0x1d8)] = new _0x4bd523(this['extensions'][_0x2dc5de][_0x535211(0x2e1)]); } static get [_0x2f608a(0x319)]() { var _0x5ae2e3 = _0x2f608a; return Game[_0x5ae2e3(0x27a)][_0x5ae2e3(0x287)][_0x5ae2e3(0x202)]('CameraTown'); } static get [_0x2f608a(0x2d2)]() { var _0x2793bc = _0x2f608a; return this[_0x2793bc(0x319)][_0x2793bc(0x2aa)]['cameraController']; } static get [_0x2f608a(0x328)]() { var _0x5c497d = _0x2f608a; return Game[_0x5c497d(0x27a)][_0x5c497d(0x1a8)][_0x5c497d(0x328)][_0x5c497d(0x253)][0x0]; } static get [_0x2f608a(0x23b)]() { var _0x20de81 = _0x2f608a; return Game[_0x20de81(0x27a)][_0x20de81(0x287)][_0x20de81(0x202)](_0x20de81(0x1d4)); } static get [_0x2f608a(0x2fc)]() { var _0x1b25cf = _0x2f608a; return this[_0x1b25cf(0x23b)]['script'][_0x1b25cf(0x2fc)]; } static [_0x2f608a(0x2e4)]() { var _0x36a23e = _0x2f608a; return document[_0x36a23e(0x254)](_0x36a23e(0x20d)); } static [_0x2f608a(0x32a)]() { var _0x5a6df7 = _0x2f608a; return [...document[_0x5a6df7(0x20a)](_0x5a6df7(0x1fd))]['find'](_0x40e45e => _0x40e45e['textContent'] == _0x5a6df7(0x1ac))?.[_0x5a6df7(0x23d)]; } static [_0x2f608a(0x29e)]() { var _0x2f8471 = _0x2f608a; return document['querySelector'](_0x2f8471(0x250)); } static [_0x2f608a(0x235)]() { var _0x5252d7 = _0x2f608a; return [...document[_0x5252d7(0x20a)](_0x5252d7(0x1fd))]['find'](_0x4a8ef2 => _0x4a8ef2[_0x5252d7(0x33c)] == 'Cancel\x20Trade')?.[_0x5252d7(0x23d)]; } static ['checkPlayPrompt']() { var _0x4fb4ac = _0x2f608a; this[_0x4fb4ac(0x2e4)]()?.[_0x4fb4ac(0x24d)](), this[_0x4fb4ac(0x29e)]()?.[_0x4fb4ac(0x24d)](); } static [_0x2f608a(0x258)]() { var _0x13bfd5 = _0x2f608a, _0x18c1b6 = document[_0x13bfd5(0x2f2)](_0x13bfd5(0x21f))?.[0x0]; _0x18c1b6?.[_0x13bfd5(0x1f8)][_0x13bfd5(0x2f1)] != 'none' && (_0x18c1b6['click'](), document[_0x13bfd5(0x1e1)](_0x13bfd5(0x216))?.[_0x13bfd5(0x2f2)](_0x13bfd5(0x2ea))?.[0x0]?.[_0x13bfd5(0x24d)]()); } static [_0x2f608a(0x1a6)]() { var _0x1241f6 = _0x2f608a, _0x6dda6c = document['getElementsByClassName'](_0x1241f6(0x2a0))?.[0x0]; _0x6dda6c?.[_0x1241f6(0x1f8)][_0x1241f6(0x2f1)] != _0x1241f6(0x310) && (_0x6dda6c['click'](), document[_0x1241f6(0x2f2)](_0x1241f6(0x334))?.[0x0]?.[_0x1241f6(0x2f2)]('yes')?.[0x0]?.[_0x1241f6(0x24d)]()); } static ['clickAt'](_0x58c736, _0x4ef610) { var _0x50ae89 = _0x2f608a; if (typeof _0x58c736 != _0x50ae89(0x295)) this[_0x50ae89(0x2d2)][_0x50ae89(0x22d)]({ 'x': _0x58c736['x'], 'y': _0x58c736['y'] }); else this[_0x50ae89(0x2d2)]['Tap']({ 'x': _0x58c736, 'y': _0x4ef610 }); } static [_0x2f608a(0x1b3)]() { var _0x536be6 = _0x2f608a; if (!this['configScreen']) { console[_0x536be6(0x2db)]('Creating\x20new\x20config\x20screen\x20...'); var _0x20ecb7 = document[_0x536be6(0x1cf)](_0x536be6(0x1f8)); _0x20ecb7['innerHTML'] = _0x536be6(0x332), document['head'][_0x536be6(0x31f)](_0x20ecb7), this[_0x536be6(0x2ad)] = document[_0x536be6(0x1cf)](_0x536be6(0x1e8)), this['configScreen'][_0x536be6(0x312)] = _0x536be6(0x1a4), this[_0x536be6(0x2ad)][_0x536be6(0x1f8)][_0x536be6(0x1f0)] = '#1a8ca0', document[_0x536be6(0x2b1)][_0x536be6(0x31f)](this[_0x536be6(0x2ad)]); for (var _0x107748 in this[_0x536be6(0x2a6)]) { let _0x428a9 = this['extensions'][_0x107748], _0x1b58e6 = _0x428a9[_0x536be6(0x2e1)][_0x536be6(0x1b3)](); if (_0x1b58e6 instanceof HTMLElement) this['configScreen'][_0x536be6(0x31f)](_0x1b58e6); } } else console[_0x536be6(0x2db)]('Config\x20screen\x20already\x20created.'); return this['configScreen']; } static [_0x2f608a(0x32d)](_0x11aa46, _0x2569a4, _0x4b2997) { var _0x4cb9e8 = _0x2f608a, _0x2aa6e8 = _0x5c2449[_0x4cb9e8(0x23c)][_0x4cb9e8(0x226)](_0x11aa46); if (_0x2aa6e8) _0x2aa6e8[_0x4cb9e8(0x344)][_0x4cb9e8(0x1ba)](_0x2aa6e8); _0x2aa6e8 = document['createElement'](_0x4cb9e8(0x1e8)), _0x2aa6e8[_0x4cb9e8(0x312)] = _0x4cb9e8(0x23e), _0x2aa6e8['style'][_0x4cb9e8(0x281)] = _0x4cb9e8(0x218), _0x2aa6e8['style']['marginRight'] = '16px', _0x2aa6e8['style'][_0x4cb9e8(0x2d8)] = _0x4cb9e8(0x218), _0x2aa6e8[_0x4cb9e8(0x1f8)][_0x4cb9e8(0x225)] = _0x4cb9e8(0x337), _0x2aa6e8[_0x4cb9e8(0x1f8)][_0x4cb9e8(0x336)] = _0x4cb9e8(0x293), _0x2aa6e8[_0x4cb9e8(0x1df)](_0x4cb9e8(0x257), _0x2b4bd7 => { var _0x2de7ea = _0x4cb9e8; if (_0x2b4bd7[_0x2de7ea(0x267)] == _0x2b4bd7['BUBBLING_PHASE']) _0x2b4bd7['stopPropagation'](); }, { 'capture': ![] }), _0x2aa6e8['addEventListener'](_0x4cb9e8(0x2d7), _0x542c48 => { var _0x3183c3 = _0x4cb9e8; if (_0x542c48[_0x3183c3(0x267)] == _0x542c48[_0x3183c3(0x2c8)]) _0x542c48['stopPropagation'](); }, { 'capture': ![] }), _0x2aa6e8['addEventListener'](_0x4cb9e8(0x200), _0xc5ed87 => { var _0x215e99 = _0x4cb9e8; if (_0xc5ed87['eventPhase'] == _0xc5ed87[_0x215e99(0x2c8)]) _0xc5ed87[_0x215e99(0x1f1)](); }, { 'capture': ![] }); var _0x41f740 = document['createElement']('h2'); return _0x41f740[_0x4cb9e8(0x1aa)] = _0x2569a4, _0x2aa6e8['appendChild'](_0x41f740), _0x2aa6e8[_0x4cb9e8(0x31f)](_0x4b2997), _0x5c2449['configScreen'][_0x4cb9e8(0x31f)](_0x2aa6e8), _0x5c2449[_0x4cb9e8(0x23c)][_0x4cb9e8(0x303)](_0x11aa46, _0x2aa6e8), _0x2aa6e8; } static [_0x2f608a(0x307)]() { var _0x586735 = _0x2f608a, _0x38485 = _0x5c2449['getConfig'](); _0x38485[_0x586735(0x1f8)][_0x586735(0x2f1)] = _0x586735(0x1b5), console[_0x586735(0x2db)](_0x586735(0x203)); } static [_0x2f608a(0x228)]() { var _0x216ce2 = _0x2f608a; return +HUD?.[_0x216ce2(0x266)]?.[_0x216ce2(0x2bf)]?.[_0x216ce2(0x2dc)][_0x216ce2(0x30c)](/,/g, '') ?? 0x0; } static ['getStoredCrafts']() { var _0x172d91 = _0x2f608a; return Game[_0x172d91(0x32e)][_0x172d91(0x297)](); } static [_0x2f608a(0x24c)](_0x12e9b7) { var _0x4d9ad1 = this['getStoredCrafts'](); return _0x4d9ad1 && _0x4d9ad1[_0x12e9b7] || 0x0; } static [_0x2f608a(0x21d)]() { var _0x2550f2 = _0x2f608a; return this[_0x2550f2(0x24c)](_0x2550f2(0x1c7)); } static ['getAllTownObjects']() { return Game['town']['objectDict']; } static *[_0x2f608a(0x273)](..._0x1991f9) { var _0x4c2d8e = _0x2f608a; for (var _0x489870 in Game[_0x4c2d8e(0x32e)][_0x4c2d8e(0x1eb)]) if (_0x1991f9['indexOf'](Game[_0x4c2d8e(0x32e)][_0x4c2d8e(0x1eb)][_0x489870]['type']) >= 0x0) yield Game['town'][_0x4c2d8e(0x1eb)][_0x489870]; } static async[_0x2f608a(0x340)]() { var _0x49c0a2 = _0x2f608a; if (!this['__hookedTradeCreateFunction']) { let _0x45cbfb = await this[_0x49c0a2(0x234)](); Game[_0x49c0a2(0x27a)]['on']('RealtimeTradeCreate', this['__hookedTradeCreateFunction'] = _0x4b5aee => { var _0x23968 = _0x49c0a2; if (!Game[_0x23968(0x2bc)]) return; var _0x331ab7 = _0x4b5aee[0x0], _0xb66cd = Object['values'](Game['world'][_0x23968(0x25c)])[_0x23968(0x2d6)](_0x576396 => _0x576396[_0x23968(0x2ee)] == _0x331ab7[_0x23968(0x2ee)])?.[0x0]; if (_0xb66cd) { let _0xce5fed = this[_0x23968(0x342)][_0x331ab7[_0x23968(0x2ee)]] || (this[_0x23968(0x342)][_0x331ab7[_0x23968(0x2ee)]] = { 'town': _0xb66cd, 'products': {} }), _0x553370 = _0xce5fed[_0x23968(0x1c6)][_0x331ab7['craftType']] || (_0xce5fed[_0x23968(0x1c6)][_0x331ab7['craftType']] = { 'count': 0x0, 'first': 0x0, 'perMin': 0x0, 'perHour': 0x0 }); if (!_0x553370[_0x23968(0x205)]) _0x553370[_0x23968(0x1cc)] = Date[_0x23968(0x31c)](); if (_0x331ab7[_0x23968(0x2ff)]['toUpperCase']() == 'FREIGHT_BOAT') _0x553370[_0x23968(0x205)] += 0x64; else _0x553370[_0x23968(0x205)] += 0xa; let _0x5ef7d3 = Date[_0x23968(0x31c)]() - _0x553370[_0x23968(0x1cc)]; _0x5ef7d3 > 0x0 && (_0x553370['perMin'] = _0x553370['count'] / (_0x5ef7d3 / 0xea60), _0x553370['perHour'] = _0x553370[_0x23968(0x205)] / (_0x5ef7d3 / 0x36ee80)); var _0x354b38 = _0x45cbfb[_0x23968(0x237)](_0x167fc2 => _0x167fc2['userId'] == _0x331ab7[_0x23968(0x2ee)]); _0x354b38 && (console[_0x23968(0x2db)]('\x20'), console['log']('---===' + _0xb66cd[_0x23968(0x1bd)] + _0x23968(0x2c5) + _0x331ab7[_0x23968(0x2fd)] + '\x20' + _0x553370['count'] + '\x20|\x20' + _0x553370[_0x23968(0x2c9)][_0x23968(0x230)](0x2) + _0x23968(0x1bb) + _0x553370[_0x23968(0x2c1)][_0x23968(0x230)](0x2)), console[_0x23968(0x2db)]('\x20')); } }), RT[_0x49c0a2(0x29c)]({ 'from': { 'x': 0x0, 'z': 0x0 }, 'to': { 'x': 0x1388, 'z': 0x1388 } }); } } static [_0x2f608a(0x234)]() { var _0x42de26 = _0x2f608a; return TSAPI[_0x42de26(0x1e7)](); } static [_0x2f608a(0x22a)]() { var _0x29d144 = _0x2f608a; for (var _0x3fdafb in this[_0x29d144(0x2a6)]) { var _0x58ad50 = this[_0x29d144(0x2a6)][_0x3fdafb]; if (!_0x58ad50['process'] && _0x58ad50[_0x29d144(0x2e1)][_0x29d144(0x2b5)]) _0x58ad50[_0x29d144(0x1c3)] = _0x58ad50[_0x29d144(0x2e1)]['onTimer'](); if (_0x58ad50[_0x29d144(0x1c3)] && _0x58ad50[_0x29d144(0x2e1)][_0x29d144(0x212)] && _0x58ad50[_0x29d144(0x1c3)]['next']()['done']) _0x58ad50[_0x29d144(0x1c3)] = void 0x0; } this['_doAsyncStuff'](); } static [_0x2f608a(0x1fb)](_0x2d774c) { var _0x4f505b = _0x2f608a, _0x999896 = typeof _0x2d774c == _0x4f505b(0x222) ? _0x2d774c[_0x4f505b(0x251)]('.')['map'](_0x3c4b37 => +_0x3c4b37) : _0x2d774c || [], _0x548220 = _0x3e30c6['version'][_0x4f505b(0x251)]('.')[_0x4f505b(0x27d)](_0x3eab08 => +_0x3eab08); if (_0x999896[0x0] > _0x548220[0x0]) return !![]; if (_0x999896[0x0] == _0x548220[0x0]) { if (_0x999896[0x1] > _0x548220[0x1]) return !![]; if (_0x999896[0x1] == _0x548220[0x1] && _0x999896[0x2] > _0x548220[0x2]) return !![]; } return ![]; } static async[_0x2f608a(0x231)]() { var _0x498727 = _0x2f608a; if (--this['pingDelay'] < 0x0) { this[_0x498727(0x220)] = 0x3c; var _0x485f41 = await _0x5c2449['askBot'](_0x498727(0x288), Game[_0x498727(0x2ee)], _0x3e30c6[_0x498727(0x1ae)]), _0x6624aa = _0x485f41[_0x498727(0x2fa)] ? _0x485f41['scriptVersion'] : []; if (this[_0x498727(0x1fb)](_0x6624aa)) { if (--this[_0x498727(0x2fb)] < 0x0) { this['upgradeDelay'] = 0x3c, console[_0x498727(0x2db)](_0x498727(0x1ee) + _0x3e30c6[_0x498727(0x1ae)] + _0x498727(0x1b9)); var _0x270a89 = await this[_0x498727(0x2c0)](); if (_0x270a89) { var _0x384a7e = _0x270a89[_0x498727(0x2b0)](/^\/\/\s*@version.*(\d+.\d+.\d+)/gmi)?.[0x0][_0x498727(0x251)]('\x20')[_0x498727(0x2ae)]()[0x0] || ''; if (this[_0x498727(0x1fb)](_0x384a7e)) { console[_0x498727(0x2db)](_0x498727(0x1fa) + _0x384a7e + '\x20***'); try { this[_0x498727(0x19d)](), new Function('TownstarExtensions', _0x270a89)(_0x3e30c6), console[_0x498727(0x2db)](_0x498727(0x1f5) + _0x384a7e + _0x498727(0x221)); } catch (_0x36cced) { console[_0x498727(0x2db)](_0x498727(0x1f5) + _0x384a7e + '\x20FAILED\x20***\x0d\x0aReason:\x20' + _0x36cced); } } else console[_0x498727(0x2db)](_0x498727(0x2e2) + _0x384a7e + _0x498727(0x269)); } else console[_0x498727(0x2db)](_0x498727(0x261)); } } } } static [_0x2f608a(0x29a)](_0x5db813) { var _0x24ee1d = _0x2f608a; if (_0x5db813[_0x24ee1d(0x267)] != _0x5db813[_0x24ee1d(0x2c8)]) return; var _0x5df334; if (window[_0x24ee1d(0x1d2)]) _0x5df334 = _0x5db813[_0x24ee1d(0x2f0)]; else _0x5db813[_0x24ee1d(0x2ab)] && (_0x5df334 = _0x5db813[_0x24ee1d(0x2ab)]); _0x5df334 == 0x53 && (!_0x5c2449[_0x24ee1d(0x2ad)] || _0x5c2449['configScreen']['style'][_0x24ee1d(0x2f1)] == _0x24ee1d(0x310) ? _0x5c2449[_0x24ee1d(0x307)]() : (_0x5c2449['configScreen']['style'][_0x24ee1d(0x2f1)] = _0x24ee1d(0x310), console['log'](_0x24ee1d(0x271)))); } static [_0x2f608a(0x2f3)]() { var _0x10faf4 = _0x2f608a; if (!_0x6bc2fa) throw _0x10faf4(0x19a); _0x5c2449['checkPlayPrompt'](); if (this[_0x10faf4(0x2d3)] == void 0x0) { for (var _0x572008 in this['extensions']) { let _0x47370a = this[_0x10faf4(0x2a6)][_0x572008]; (_0x47370a[_0x10faf4(0x306)] || !oldGameExt) && (_0x47370a[_0x10faf4(0x2e1)][_0x10faf4(0x2f3)](), console[_0x10faf4(0x2db)](_0x10faf4(0x2af) + _0x572008 + _0x10faf4(0x25b))); } for (var _0x486a2b of _0x3e30c6[_0x10faf4(0x276)]) { if (typeof _0x486a2b == 'function') _0x486a2b[_0x10faf4(0x24b)](_0x3e30c6); } return _0x3e30c6[_0x10faf4(0x276)] = [], this[_0x10faf4(0x340)](), this[_0x10faf4(0x2d3)] = setInterval(() => this['_startProcess'](), 0x3e8), document[_0x10faf4(0x1df)](_0x10faf4(0x204), this[_0x10faf4(0x2ce)] = this[_0x10faf4(0x29a)][_0x10faf4(0x1ad)](this), { 'capture': ![] }), console['log']('Main\x20timer\x20started.'), !![]; } else console[_0x10faf4(0x2db)](_0x10faf4(0x22b)); return ![]; } static [_0x2f608a(0x19d)]() { var _0x41ae0a = _0x2f608a; if (this[_0x41ae0a(0x2d3)] !== void 0x0) return clearInterval(this[_0x41ae0a(0x2d3)]), this[_0x41ae0a(0x2d3)] = void 0x0, this[_0x41ae0a(0x2ce)] && (document['removeEventListener'](_0x41ae0a(0x204), this[_0x41ae0a(0x2ce)]), this[_0x41ae0a(0x2ce)] = null), this[_0x41ae0a(0x1e9)] && (Game['app'][_0x41ae0a(0x1e0)](this['__hookedTradeCreateFunction']), this[_0x41ae0a(0x1e9)] = null), console[_0x41ae0a(0x2db)](_0x41ae0a(0x1cb)), !![]; else console[_0x41ae0a(0x2db)](_0x41ae0a(0x32f)); return ![]; } static async[_0x2f608a(0x289)](_0x33aca5, ..._0x4b51c1) { var _0x470877 = _0x2f608a; try { console[_0x470877(0x2db)](_0x470877(0x20e), _0x5afa85); var _0x4e9c82 = await fetch(_0x470877(0x1b0), { 'method': _0x470877(0x1a2), 'mode': _0x470877(0x21e), 'headers': { 'Content-Type': _0x470877(0x224) }, 'body': JSON['stringify']({ 'cmd': _0x33aca5, 'data': _0x4b51c1 }) }), _0x5afa85 = await _0x4e9c82[_0x470877(0x25f)](); return console['log'](_0x470877(0x229), _0x5afa85), _0x5afa85; } catch (_0x27b102) { return console[_0x470877(0x232)](_0x470877(0x1ca) + _0x27b102), void 0x0; } } static async[_0x2f608a(0x2c0)]() { var _0x5a1aae = _0x2f608a; try { console[_0x5a1aae(0x2db)](_0x5a1aae(0x2de)); var _0x445e5d = await fetch(_0x5a1aae(0x323), { 'method': _0x5a1aae(0x2ca), 'mode': _0x5a1aae(0x21e), 'headers': { 'Content-Type': _0x5a1aae(0x1d9) } }), _0x1ba8c1 = await _0x445e5d['text'](); return console[_0x5a1aae(0x2db)](_0x5a1aae(0x1d3), ('' + _0x1ba8c1)[_0x5a1aae(0x24e)](0x0, 0x100)), _0x1ba8c1; } catch (_0x32c13e) { return console[_0x5a1aae(0x232)](_0x5a1aae(0x1da) + _0x32c13e), void 0x0; } } static [_0x2f608a(0x33e)](_0x18ee16) { var _0x3af2f5 = _0x2f608a; let _0x345a95 = document[_0x3af2f5(0x1cf)](_0x3af2f5(0x1e8)); return _0x345a95['innerHTML'] = _0x3af2f5(0x21c) + _0x18ee16 + '</span>', _0x345a95; } static [_0x2f608a(0x299)](_0x338787) { var _0x1902f6 = _0x2f608a; let _0x23c2cc = document[_0x1902f6(0x1cf)](_0x1902f6(0x30d)); return _0x23c2cc[_0x1902f6(0x23a)] = _0x1902f6(0x2d4), _0x23c2cc[_0x1902f6(0x1f8)]['width'] = _0x1902f6(0x270), _0x23c2cc[_0x1902f6(0x1f8)][_0x1902f6(0x259)] = _0x1902f6(0x270), _0x23c2cc[_0x1902f6(0x2c6)] = !!_0x338787, _0x23c2cc; } static ['createInputElement'](_0x1f0e4a) { var _0x248859 = _0x2f608a; let _0x2c96ad = document['createElement'](_0x248859(0x30d)); return _0x2c96ad[_0x248859(0x23a)] = _0x248859(0x1b1), _0x2c96ad[_0x248859(0x1f8)][_0x248859(0x2d8)] = _0x248859(0x198), _0x2c96ad[_0x248859(0x1f8)]['height'] = _0x248859(0x270), _0x2c96ad[_0x248859(0x1f8)]['fontSize'] = _0x248859(0x2c4), _0x2c96ad[_0x248859(0x1f8)][_0x248859(0x333)] = _0x248859(0x2bb), _0x2c96ad[_0x248859(0x213)] = _0x5014a5 => _0x5014a5[_0x248859(0x1f1)](), _0x2c96ad[_0x248859(0x1a5)] = '' + _0x1f0e4a, _0x2c96ad; } } _0x5c2449[_0x2f608a(0x2a6)] = {}, _0x5c2449[_0x2f608a(0x23c)] = new Map(), _0x5c2449[_0x2f608a(0x342)] = {}, _0x5c2449[_0x2f608a(0x220)] = 0x0, _0x5c2449[_0x2f608a(0x2fb)] = 0x0, _0x3e30c6[_0x2f608a(0x275)] = _0x5c2449, function (_0x25fe6c) { var _0x4eb2bc = _0x2f608a; if (typeof debugging != _0x4eb2bc(0x26d) && debugging) debugger; if (oldGameExt) { console[_0x4eb2bc(0x2db)]('Replacing\x20previous\x20API\x20instance...'), oldGameExt[_0x4eb2bc(0x19d)](), _0x25fe6c['extensions'] = oldGameExt[_0x4eb2bc(0x2a6)]; if (oldGameExt[_0x4eb2bc(0x2ad)]) oldGameExt[_0x4eb2bc(0x2ad)]['parentNode']['removeChild'](oldGameExt['configScreen']); console[_0x4eb2bc(0x2db)](_0x4eb2bc(0x282)); } }(_0x5c2449 = _0x3e30c6[_0x2f608a(0x275)] || (_0x3e30c6[_0x2f608a(0x275)] = {})); async function _0x4f8e6e() { var _0x6b93b3 = _0x2f608a, _0x395f60 = await _0x5c2449[_0x6b93b3(0x289)](_0x6b93b3(0x304), Game['userId'], Game[_0x6b93b3(0x274)], Game['townName']); if (!_0x395f60 || !_0x395f60[_0x6b93b3(0x207)] || _0x395f60[_0x6b93b3(0x207)] != 'OK') { console['log'](_0x6b93b3(0x320), JSON[_0x6b93b3(0x2bd)](_0x395f60)); const _0x121c11 = _0x6b93b3(0x268); console[_0x6b93b3(0x2db)](_0x121c11), alert(_0x121c11); } _0x6bc2fa = !![], Game['OnLostConnection'] = function _0x31b854() { var _0x507a5c = _0x6b93b3; this['internetConnected'] && (this['internetConnected'] = !0x1, this[_0x507a5c(0x27a)][_0x507a5c(0x29f)] = !0x1); }, _0x5c2449[_0x6b93b3(0x2f3)](); } _0x3e30c6[_0x2f608a(0x2f3)] = _0x4f8e6e, _0x3e30c6['ts'] = () => 0x1; class _0xa9b332 { constructor(_0x2f17a3) { var _0x55b1d3 = _0x2f608a; this[_0x55b1d3(0x236)] = [], this[_0x55b1d3(0x211)] = {}, this['avgTrends'] = {}, this['counter'] = 0x0, this[_0x55b1d3(0x325)] = 0x0, this[_0x55b1d3(0x2a2)] = 0x1e, this[_0x55b1d3(0x28c)] = 0x0, this[_0x55b1d3(0x2a3)] = 0x2710, this['negativeIncomeThreshold'] = 0x3c * 0x3c, this[_0x55b1d3(0x2e8)] = !![], this[_0x55b1d3(0x26e)] = 0x0, this[_0x55b1d3(0x212)] = ![]; if (_0x2f17a3) { this['currencyTrends'] = _0x2f17a3[_0x55b1d3(0x236)][_0x55b1d3(0x22f)](), this['currencyTrends'] = _0x2f17a3[_0x55b1d3(0x236)][_0x55b1d3(0x22f)](); for (var _0x465ec2 in _0x2f17a3[_0x55b1d3(0x211)]) { this['itemTrends'][_0x465ec2] = _0x2f17a3[_0x55b1d3(0x211)][_0x465ec2][_0x55b1d3(0x22f)](), this['avgTrends'][_0x465ec2] = _0x2f17a3[_0x55b1d3(0x248)][_0x465ec2]; } console['log']('\x27Analyzer\x27\x20was\x20updated.'); } else console['log'](_0x55b1d3(0x2ec)); } [_0x2f608a(0x1af)](_0x17c18a, _0x2e7260) { var _0x2e6eb7 = _0x2f608a, _0x2510a3 = {}, _0x2d8ed5 = [], _0x46d75a = typeof _0x2e7260 == _0x2e6eb7(0x222) ? _0x2e7260[_0x2e6eb7(0x251)](',')[_0x2e6eb7(0x27d)]((_0x5aa3e3, _0x3c12d3) => (_0x5aa3e3 = _0x5aa3e3['trim'](), _0x2510a3[_0x5aa3e3] = _0x3c12d3, _0x5aa3e3)) : _0x2e7260 ?? []; for (var _0x510d40 in _0x17c18a) { var _0x1ac407 = [_0x510d40]; for (var _0x18f198 in _0x17c18a[_0x510d40]) { !(_0x18f198 in _0x2510a3) && (_0x2510a3[_0x18f198] = _0x46d75a[_0x2e6eb7(0x321)], _0x46d75a['push'](_0x18f198)), _0x1ac407[_0x2510a3[_0x18f198]] = _0x17c18a[_0x510d40][_0x18f198]; } _0x2d8ed5['push'](_0x1ac407); } return [_0x46d75a, ..._0x2d8ed5]; } [_0x2f608a(0x252)](_0x30ec66) { var _0x8c65f0 = _0x2f608a, _0xc4d9a2 = ''; if (_0x30ec66['length']) for (var _0x5d81d3 = 0x0, _0x5e0b97 = _0x30ec66['length']; _0x5d81d3 < _0x5e0b97; ++_0x5d81d3) { var _0x2419f4 = ''; for (var _0x3a03b0 = 0x0, _0x5df15b = _0x30ec66[_0x5d81d3][_0x8c65f0(0x321)]; _0x3a03b0 < _0x5df15b; ++_0x3a03b0)_0x2419f4 += (_0x2419f4 ? '\x09' : '') + _0x30ec66[_0x5d81d3][_0x3a03b0]; _0xc4d9a2 += (_0xc4d9a2 ? '\x0d\x0a' : '') + _0x2419f4; } return _0xc4d9a2; } [_0x2f608a(0x2b7)]() { var _0xd514ac = _0x2f608a, _0x31f381 = this[_0xd514ac(0x1af)](Game[_0xd514ac(0x2c3)], 'Name,BlockChainID,BuildCost,CanBuildUpon,CanSelectCraft,Capacity,Class,CraftReqsMet,CraftTimeMod,Crafts,DeliverTypes,Description,DestroyCost,Destroyable,EdgeClass,EdgeRequirements,GoldCost,HasDynamicGround,Id,InStore,LaborCost,PathBase,PathMask,PathMaskType,ProximityDist,ProximityEmit,ProximityImmune,Rotatable,RotateTo,StorageType,TargetTypes,TileWith,UTValue,UnitType'); return this['exportTable'](_0x31f381); } [_0x2f608a(0x2cb)]() { var _0x433d04 = _0x2f608a, _0x14ed7f = this['makeTable'](Game['craftData'], _0x433d04(0x2b6)); return this[_0x433d04(0x252)](_0x14ed7f); } [_0x2f608a(0x316)](_0x5d67f2) { var _0x1d7390 = _0x2f608a; if (!_0x5d67f2 || !_0x5d67f2[_0x1d7390(0x321)]) return 0x0; var _0x2769d7 = 0x0; for (var _0x5749db = 0x0, _0x268d1a = _0x5d67f2[_0x1d7390(0x321)] - 0x2; _0x5749db < _0x268d1a; ++_0x5749db)_0x2769d7 += _0x5d67f2[_0x5749db + 0x1] - _0x5d67f2[_0x5749db]; return _0x2769d7 /= _0x5d67f2[_0x1d7390(0x321)]; } [_0x2f608a(0x23f)](_0x1d15de, _0x2325d3) { var _0x3af5bb = _0x2f608a; _0x1d15de[_0x3af5bb(0x227)]('transform', _0x3af5bb(0x2eb) + _0x2325d3 + ')'); } [_0x2f608a(0x314)](_0x140899, _0x410c8d, _0x51ec4c, _0x56f885, _0x516c30) { var _0x460f4d = _0x2f608a, _0x29ceaf = Math['abs'](_0x51ec4c / _0x56f885 * 0x3c * _0x3e30c6['ts']()); _0x29ceaf = (_0x29ceaf <= 0x1 ? _0x29ceaf : 0x1) * Math[_0x460f4d(0x30b)](_0x51ec4c); if (_0x516c30) var _0x507a1b = Math[_0x460f4d(0x21a)](Math[_0x460f4d(0x1b7)](_0x29ceaf) * 0xf), _0x84f626 = Math['round']((0x1 - Math[_0x460f4d(0x1b7)](_0x29ceaf)) * 0xb), _0x179a4e = Math[_0x460f4d(0x21a)]((0x1 - Math[_0x460f4d(0x1b7)](-0.5 + Math[_0x460f4d(0x1b7)](_0x29ceaf))) * 0x1); else var _0x507a1b = Math[_0x460f4d(0x21a)]((0x1 - (0x1 + _0x29ceaf) / 0x2) * 0xf), _0x84f626 = Math[_0x460f4d(0x21a)]((0x1 + _0x29ceaf) / 0x2 * 0xb), _0x179a4e = 0x0; var _0x4dde23 = _0x29ceaf * -0x2d, _0x5d2ca2 = _0x410c8d[_0x460f4d(0x254)](_0x460f4d(0x280)); if (this['fistTimeRefresh'] || !_0x5d2ca2) { if (_0x5d2ca2) _0x410c8d[_0x460f4d(0x1ba)](_0x5d2ca2); _0x5d2ca2 = document[_0x460f4d(0x1cf)]('div'), _0x410c8d[_0x460f4d(0x31f)](_0x5d2ca2), _0x5d2ca2[_0x460f4d(0x312)] = _0x460f4d(0x1f4); } _0x5d2ca2['innerHTML'] = '<svg\x20class=\x22arrow\x22\x20width=\x2250px\x22\x20height=\x2230px\x22>\x0a\x09\x09\x09<defs>\x0a\x09\x09\x09<marker\x20id=\x22arrowHead_' + _0x140899 + _0x460f4d(0x2e5) + _0x507a1b[_0x460f4d(0x294)](0x10) + _0x84f626[_0x460f4d(0x294)](0x10) + _0x179a4e[_0x460f4d(0x294)](0x10) + '\x22\x20/>\x0a\x09\x09\x09</marker>\x0a\x09\x09\x09</defs>\x0a\x09\x09\x09<line\x20id=\x22line\x22\x20x1=\x2210\x22\x20y1=\x2215\x22\x20x2=\x2230\x22\x20y2=\x2215\x22\x20stroke=\x22#' + _0x507a1b[_0x460f4d(0x294)](0x10) + _0x84f626[_0x460f4d(0x294)](0x10) + _0x179a4e[_0x460f4d(0x294)](0x10) + _0x460f4d(0x27b) + _0x140899 + ')\x22\x20/>\x0a\x09\x09\x09</svg>'; var _0x29ac1a = _0x5d2ca2[_0x460f4d(0x254)]('.arrow'), _0x55aba1 = _0x51ec4c * _0x3e30c6['ts'](), _0xe2e279 = _0x460f4d(0x30f) + _0x55aba1['toFixed'](0x2) + '\x20/\x20per\x20min:\x20' + (_0x55aba1 * 0x3c)[_0x460f4d(0x230)](0x2) + _0x460f4d(0x1ce) + (_0x55aba1 * 0x3c * 0x3c)[_0x460f4d(0x230)](0x2), _0x7775ef = _0x5c2449['getWages'](); if (_0x516c30) { var _0x3202d8 = Game[_0x460f4d(0x28d)] / _0x7775ef, _0x1ef97f = _0x51ec4c * 0x3c * _0x3202d8; if (_0x1ef97f < 0x0) _0x1ef97f = _0x460f4d(0x199); _0xe2e279 += '\x20/\x20By\x20funds\x20end:\x20' + _0x1ef97f; } else _0xe2e279 += _0x460f4d(0x2cd) + _0x7775ef + '\x20(mins):\x20' + (Game[_0x460f4d(0x28d)] / _0x7775ef / _0x3e30c6['ts']())[_0x460f4d(0x230)](0x2) + _0x460f4d(0x1d6) + (Game['currency'] / _0x7775ef / 0x3c / _0x3e30c6['ts']())['toFixed'](0x2); _0x5d2ca2[_0x460f4d(0x227)](_0x460f4d(0x264), _0xe2e279), _0x5d2ca2[_0x460f4d(0x227)](_0x460f4d(0x1f8), _0x460f4d(0x260)), this[_0x460f4d(0x23f)](_0x29ac1a, _0x4dde23); } [_0x2f608a(0x308)]() { var _0x53937d = _0x2f608a, _0x3ae299 = this[_0x53937d(0x248)]; for (var _0x56bc04 in _0x3ae299) { var _0xfdef1c = _0x3ae299[_0x56bc04], _0x4984ae = document['querySelector'](_0x53937d(0x346) + _0x56bc04 + _0x53937d(0x322)); if (!_0x4984ae) continue; _0x4984ae[_0x53937d(0x1f8)][_0x53937d(0x2d8)] = _0x53937d(0x272), this[_0x53937d(0x314)](_0x56bc04, _0x4984ae, _0xfdef1c, 0x1, !![]); } var _0x4984ae = document[_0x53937d(0x254)](_0x53937d(0x25e)); if (_0x4984ae && this[_0x53937d(0x236)][_0x53937d(0x321)] > 0x2) { var _0x4f7548 = _0x5c2449[_0x53937d(0x228)](); this[_0x53937d(0x314)](_0x53937d(0x318), _0x4984ae, this[_0x53937d(0x26e)], _0x4f7548, ![]); } this[_0x53937d(0x2e8)] = ![]; } *[_0x2f608a(0x2b5)]() { var _0x547d25 = _0x2f608a; if (!_0x5c2449[_0x547d25(0x300)]) return; var _0x39f070 = this[_0x547d25(0x236)], _0x35ffbd = this[_0x547d25(0x211)], _0x52bf3e = this['avgTrends']; while (_0x39f070[_0x547d25(0x321)] > 0x0 && _0x39f070[_0x547d25(0x321)] > this[_0x547d25(0x2a2)] * 0x3c) _0x39f070[_0x547d25(0x278)](); _0x39f070['push'](Game[_0x547d25(0x28d)]); var _0x31143f = _0x5c2449[_0x547d25(0x2b8)](); if (_0x31143f) for (var _0xe5d677 in _0x31143f) { var _0x3defd2 = _0x35ffbd[_0xe5d677] || (_0x35ffbd[_0xe5d677] = []); while (_0x3defd2[_0x547d25(0x321)] > 0x0 && _0x3defd2[_0x547d25(0x321)] > this[_0x547d25(0x2a2)] * 0x3c) _0x3defd2[_0x547d25(0x278)](); _0x35ffbd[_0xe5d677][_0x547d25(0x1c0)](_0x31143f[_0xe5d677]); } if (_0x39f070[_0x547d25(0x321)] > 0x2 && this[_0x547d25(0x1d5)] % 0xa == 0x0) { this['incomeChangeAvg'] = this[_0x547d25(0x316)](_0x39f070); var _0x1d8b05 = _0x5c2449[_0x547d25(0x228)](); console[_0x547d25(0x2db)](Array(0x32)['join']('-')), console[_0x547d25(0x2db)](_0x547d25(0x1f7) + (this[_0x547d25(0x26e)] * 0x3c * _0x3e30c6['ts']())[_0x547d25(0x230)](0x3)), console[_0x547d25(0x2db)](_0x547d25(0x1c5) + _0x1d8b05 + _0x547d25(0x31a) + (Game[_0x547d25(0x28d)] / _0x1d8b05 / _0x3e30c6['ts']())[_0x547d25(0x230)](0x3) + _0x547d25(0x1d6) + (Game[_0x547d25(0x28d)] / _0x1d8b05 / 0x3c / _0x3e30c6['ts']())[_0x547d25(0x230)](0x3)); for (var _0xe5d677 in _0x35ffbd) { var _0x3defd2 = _0x35ffbd[_0xe5d677]; if (_0x3defd2['length'] > 0x1) { var _0x4d0299 = this[_0x547d25(0x316)](_0x3defd2); _0x52bf3e[_0xe5d677] = _0xe5d677 in _0x52bf3e ? ((_0x52bf3e[_0xe5d677] || 0x0) + _0x4d0299) / 0x2 : _0x4d0299, console[_0x547d25(0x2db)]('Trend\x20for\x20\x27' + _0xe5d677 + _0x547d25(0x1de) + (_0x4d0299 * 0x3c * _0x3e30c6['ts']())[_0x547d25(0x230)](0x3)); } } } ++this[_0x547d25(0x1d5)]; if (this[_0x547d25(0x26e)] < 0x0 && this['negativeIncomeThreshold'] > 0x0) { ++this[_0x547d25(0x325)]; if (this[_0x547d25(0x325)] >= this[_0x547d25(0x24f)]) { console[_0x547d25(0x2db)](_0x547d25(0x21b) + this[_0x547d25(0x24f)] + '\x20seconds\x20was\x20reached\x20due\x20to\x20constant\x20negative\x20income\x20of\x20' + this['incomeChangeAvg'] + '.'), console['log']('Counter\x20is\x20now\x20reset.\x20Unpause\x20to\x20continue.\x20The\x20game\x20will\x20pause\x20if\x20the\x20threshold\x20is\x20reached\x20again.'), this[_0x547d25(0x325)] = 0x0; debugger; } else this['negativeIncomeCounter'] >= this[_0x547d25(0x24f)] * 0.5 && this[_0x547d25(0x325)] % 0xa == 0x0 && (console['log'](_0x547d25(0x284)), console[_0x547d25(0x2db)](_0x547d25(0x1ea) + this['negativeIncomeCounter'] + _0x547d25(0x1b4) + this['negativeIncomeThreshold'] + _0x547d25(0x301))); } else { if (this['negativeIncomeCounter'] > 0x0) console[_0x547d25(0x2db)]('Currency\x20was\x20on\x20a\x20negative\x20trend\x20for\x20awhile,\x20but\x20recovered.'); this[_0x547d25(0x325)] = 0x0; } this[_0x547d25(0x308)](); } [_0x2f608a(0x1d1)]() { var _0x342435 = _0x2f608a; this['currencyTrends'] = [], this[_0x342435(0x211)] = {}, this[_0x342435(0x248)] = {}, this[_0x342435(0x26e)] = 0x0, this[_0x342435(0x325)] = 0x0; } [_0x2f608a(0x1b3)]() { var _0x463da8 = _0x2f608a; if (!this[_0x463da8(0x290)]) return null; else console['log'](_0x463da8(0x1ef)); return this['configWindow']; } ['start']() { var _0x2f731f = _0x2f608a; if (!this['started']) return this[_0x2f731f(0x212)] = !![], console['log'](_0x2f731f(0x2e6)), !![]; return ![]; } [_0x2f608a(0x19d)]() { var _0x2aef03 = _0x2f608a; if (this[_0x2aef03(0x212)]) return this[_0x2aef03(0x212)] = ![], this['counter'] = 0x0, console[_0x2aef03(0x2db)]('Analyzing\x20stopped.'), !![]; return ![]; } } _0x3e30c6['Analyzer'] = _0xa9b332;; (function (_0x1fbf7c) { var _0x5cbc6f = _0x2f608a; _0x5c2449['register'](_0x5cbc6f(0x27c), _0x1fbf7c); }(_0xa9b332 = _0x3e30c6[_0x2f608a(0x27c)] || (_0x3e30c6[_0x2f608a(0x27c)] = {}))); class _0x5b2a84 { constructor(_0x2917e1) { var _0x2119fc = _0x2f608a; this[_0x2119fc(0x212)] = ![]; if (_0x2917e1) console['log'](_0x2119fc(0x244)); else console['log'](_0x2119fc(0x2ed)); } static [_0x2f608a(0x29a)](_0x19d91a) { var _0x5e6c83 = _0x2f608a, _0x4b90c0; if (window[_0x5e6c83(0x1d2)]) _0x4b90c0 = _0x19d91a[_0x5e6c83(0x2f0)]; else _0x19d91a['which'] && (_0x4b90c0 = _0x19d91a[_0x5e6c83(0x2ab)]); if (_0x4b90c0 == 0x2e) { var _0x4f3c3f = document[_0x5e6c83(0x254)](_0x5e6c83(0x1dc)); if (_0x4f3c3f) _0x4f3c3f['click'](); } else { if (_0x4b90c0 == 0x55) { var _0x4f3c3f = document['querySelector'](_0x5e6c83(0x2a1)); if (_0x4f3c3f) _0x4f3c3f['click'](); } } } [_0x2f608a(0x1b3)]() { var _0x4874a6 = _0x2f608a; if (!this[_0x4874a6(0x290)]) return null; else console[_0x4874a6(0x2db)](_0x4874a6(0x1ef)); return this[_0x4874a6(0x290)]; } [_0x2f608a(0x2f3)]() { var _0x3a3411 = _0x2f608a; if (!this['started']) return document[_0x3a3411(0x1df)](_0x3a3411(0x204), _0x5b2a84['onKeyEvent']), this[_0x3a3411(0x212)] = !![], console[_0x3a3411(0x2db)](_0x3a3411(0x292)), !![]; return ![]; } [_0x2f608a(0x19d)]() { var _0x3f4aa3 = _0x2f608a; if (this['started']) return this[_0x3f4aa3(0x212)] = ![], document[_0x3f4aa3(0x256)](_0x3f4aa3(0x204), _0x5b2a84[_0x3f4aa3(0x29a)]), console[_0x3f4aa3(0x2db)](_0x3f4aa3(0x249)), !![]; return ![]; } } _0x3e30c6[_0x2f608a(0x246)] = _0x5b2a84, function (_0x22a23e) { var _0x5b5e6a = _0x2f608a; _0x5c2449[_0x5b5e6a(0x329)](_0x5b5e6a(0x246), _0x22a23e); }(_0x5b2a84 = _0x3e30c6[_0x2f608a(0x246)] || (_0x3e30c6[_0x2f608a(0x246)] = {})); class _0x205553 { constructor(_0x262c1d) { var _0x5a77ab = _0x2f608a; this['items'] = { 'Blue_Steel': { 'min': 0x9 }, 'Steel': { 'min': 0x9 }, 'Pumpkin_Pie': { 'min': 0x9 }, 'Pinot_Noir_Vines': { 'min': 0x9 }, 'Cake': { 'min': 0x9 }, 'Batter': { 'min': 0x9 }, 'Uniforms': { 'min': 0x9 }, 'Wool_Yarn': { 'min': 0x9 }, 'Cotton_Yarn': { 'min': 0x9 }, 'Butter': { 'min': 0x9 }, 'Iron': { 'min': 0x9 }, 'Sugar': { 'min': 0x9 }, 'Flour': { 'min': 0x9 }, 'Eggs': { 'min': 0x9, 'gas': 0x3 }, 'Milk': { 'min': 0x9, 'gas': 0x3 }, 'Salt': { 'min': 0x9, 'gas': 0x3 }, 'Jet_Fuel': { 'min': 0x9, 'gas': 0x3 }, 'Lumber': { 'min': 0x9, 'gas': 0x4 }, 'Wood': { 'min': 0xa, 'gas': 0x1e }, 'Feed': { 'min': 0x9, 'gas': 0xa }, 'Sugarcane': { 'min': 0xc, 'gas': 0xa }, 'Wheat': { 'min': 0x9, 'gas': 0x1e }, 'Petroleum': { 'min': 0x9, 'gas': 0x1e }, 'Wool': { 'min': 0x9, 'gas': 0xa }, 'Cotton': { 'min': 0x9, 'gas': 0x1e }, 'Water': { 'min': 0x9, 'gas': 0x27 }, 'Water_Drum': { 'min': 0x9, 'gas': 0x27 }, 'Energy': { 'min': 0x9, 'gas': 0x1e }, 'Brine': { 'min': 0x9, 'gas': 0x27 }, 'Gasoline': { 'min': 0x28, 'gas': 0x28 } }, this['sellStartAt'] = 0x0, this['waitCounter'] = 0x0, this['started'] = ![]; if (_0x262c1d) { if (_0x262c1d[_0x5a77ab(0x26f)]) window['removeEventListener'](_0x5a77ab(0x2d7), _0x262c1d[_0x5a77ab(0x26f)]); console['log'](_0x5a77ab(0x1a0)); } else console[_0x5a77ab(0x2db)](_0x5a77ab(0x1c1)); window['addEventListener'](_0x5a77ab(0x2d7), this[_0x5a77ab(0x26f)] = this[_0x5a77ab(0x311)][_0x5a77ab(0x1ad)](this)); } [_0x2f608a(0x311)](_0xc0ab64) { this['waitCounter'] = 0x5; } static [_0x2f608a(0x1c9)](_0x3bd145) { var _0x46cbd0 = +(_0x3bd145 === null ? void 0x0 : _0x3bd145); return isNaN(_0x46cbd0) ? void 0x0 : _0x46cbd0; } [_0x2f608a(0x1f2)]() { var _0x131a62 = _0x2f608a; console[_0x131a62(0x2db)](_0x131a62(0x2a9)), this['items'] = this[_0x131a62(0x2c2)] || {}; var _0x856571 = localStorage[_0x131a62(0x345)](_0x131a62(0x2dd)); if (_0x856571) { console['log'](_0x131a62(0x1c4)); var _0x2dec79 = JSON[_0x131a62(0x2cc)](_0x856571); console['log'](_0x131a62(0x33d) + _0x856571); } for (var _0x1c59bd in _0x2dec79) { this[_0x131a62(0x2c2)][_0x1c59bd] = _0x2dec79[_0x1c59bd]; let _0x58a7f2 = this['items'][_0x1c59bd]; _0x58a7f2[_0x131a62(0x28b)] = _0x205553[_0x131a62(0x1c9)](_0x58a7f2['min']), _0x58a7f2[_0x131a62(0x341)] = _0x205553['toNumber'](_0x58a7f2[_0x131a62(0x341)]), _0x58a7f2[_0x131a62(0x210)] = _0x205553[_0x131a62(0x1c9)](_0x58a7f2[_0x131a62(0x210)]); } for (var _0x1c59bd in Game[_0x131a62(0x197)]) if (!(_0x1c59bd in this[_0x131a62(0x2c2)])) this['items'][_0x1c59bd] = { 'min': 0x0, 'craftData': Game[_0x131a62(0x197)][_0x1c59bd], 'minForJimmy': 0xa }; else this[_0x131a62(0x2c2)][_0x1c59bd][_0x131a62(0x197)] = Game[_0x131a62(0x197)][_0x1c59bd]; for (var _0x1c59bd in this['items']) if (!(_0x1c59bd in Game['craftData'])) delete this['items'][_0x1c59bd]; console[_0x131a62(0x2db)](_0x131a62(0x24a)); } [_0x2f608a(0x2da)]() { var _0x20fe49 = _0x2f608a; console[_0x20fe49(0x2db)](_0x20fe49(0x2b3)); var _0x5219ff = this[_0x20fe49(0x2c2)], _0xdfbb57 = {}; for (var _0x240d21 in _0x5219ff) { let _0x1b92cb = _0x5219ff[_0x240d21]; _0xdfbb57[_0x240d21] = { 'disabled': !!_0x1b92cb[_0x20fe49(0x335)], 'min': _0x205553[_0x20fe49(0x1c9)](_0x1b92cb[_0x20fe49(0x28b)]), 'gas': _0x205553[_0x20fe49(0x1c9)](_0x1b92cb['gas']), 'minForJimmy': _0x205553['toNumber'](_0x1b92cb[_0x20fe49(0x210)]) }; } var _0x2315a5 = JSON[_0x20fe49(0x2bd)](_0xdfbb57); console[_0x20fe49(0x2db)](_0x20fe49(0x33b) + _0x2315a5), localStorage[_0x20fe49(0x1a9)]('tsext_items', _0x2315a5), console['log'](_0x20fe49(0x1f6)); } ['getTradeItemElement'](_0xfc22c8) { var _0x5413de = _0x2f608a; return document[_0x5413de(0x254)](_0x5413de(0x28a) + _0xfc22c8 + '\x27]'); } [_0x2f608a(0x2b2)]() { var _0x21fc92 = _0x2f608a; return document['querySelector'](_0x21fc92(0x2df))['style'][_0x21fc92(0x2f1)] == ''; } [_0x2f608a(0x1d7)]() { var _0x29d790 = _0x2f608a; return !!document[_0x29d790(0x254)]('.container:not([style*=\x27display:none\x27]):not([style*=\x27display:\x20none\x27])\x20.trade'); } [_0x2f608a(0x1f9)]() { var _0xdb0ddd = _0x2f608a; return !!document[_0xdb0ddd(0x254)](_0xdb0ddd(0x239)); } ['openSellMenu']() { var _0x1c02e2 = _0x2f608a; if (!this['tradeIsOpen']()) console['log'](_0x1c02e2(0x339)), document[_0x1c02e2(0x254)](_0x1c02e2(0x2df))[_0x1c02e2(0x24d)](); else console[_0x1c02e2(0x2db)](_0x1c02e2(0x214)); } ['sell']() { var _0x4515fd = _0x2f608a; console[_0x4515fd(0x2db)](_0x4515fd(0x209)), this['sellStartAt'] = Date[_0x4515fd(0x31c)](), document[_0x4515fd(0x254)](_0x4515fd(0x241))?.[_0x4515fd(0x24d)](); } [_0x2f608a(0x1e4)]() { var _0x57228e = _0x2f608a, _0x55c9eb = document[_0x57228e(0x254)](_0x57228e(0x241)), _0x1ee506 = _0x55c9eb?.[_0x57228e(0x2dc)]['split']('\x0a'); return _0x1ee506 && +_0x1ee506[_0x1ee506['length'] - 0x1] || 0x1; } [_0x2f608a(0x27e)]() { var _0x402b73 = _0x2f608a; return !!document[_0x402b73(0x254)]('.trade-connection\x20.compass'); } [_0x2f608a(0x2f4)]() { var _0x5764e7 = _0x2f608a; return !!document[_0x5764e7(0x254)](_0x5764e7(0x296)); } *[_0x2f608a(0x309)]() { var _0x2c0573 = _0x2f608a; yield* _0x5c2449[_0x2c0573(0x273)](_0x2c0573(0x2e7)), yield* _0x5c2449[_0x2c0573(0x273)](_0x2c0573(0x217)); } *['getFreightPiers']() { var _0x388ee7 = _0x2f608a; yield* _0x5c2449[_0x388ee7(0x273)](_0x388ee7(0x2f9)); } *[_0x2f608a(0x331)]() { var _0x1a1b9b = _0x2f608a; yield* _0x5c2449[_0x1a1b9b(0x273)](_0x1a1b9b(0x2e7), _0x1a1b9b(0x217), 'Freight_Pier', _0x1a1b9b(0x2d0)); } *[_0x2f608a(0x2ac)]() { var _0x4a8045 = _0x2f608a; yield* _0x5c2449[_0x4a8045(0x273)](_0x4a8045(0x2f8)); } [_0x2f608a(0x2be)](_0x3b2455) { var _0x26376c = _0x2f608a; return Date[_0x26376c(0x31c)]() > Date[_0x26376c(0x2cc)](_0x3b2455['startTime']) + _0x3b2455['duration']; } [_0x2f608a(0x286)]() { var _0x38c0be = _0x2f608a; for (var _0x4e0d18 of this[_0x38c0be(0x331)]()) { var _0x55f1c4 = Game[_0x38c0be(0x32e)]['GetActiveTradeData']({ 'x': _0x4e0d18[_0x38c0be(0x1ff)], 'z': _0x4e0d18['townZ'] }); _0x55f1c4 && this[_0x38c0be(0x2be)](_0x55f1c4) && (console[_0x38c0be(0x2db)](_0x38c0be(0x1fc)), _0x5c2449[_0x38c0be(0x238)](_0x5c2449[_0x38c0be(0x328)]['worldToScreen'](_0x4e0d18[_0x38c0be(0x32c)][_0x38c0be(0x28e)]))); } } ['findAvailableTrade'](_0x250959) { var _0x14b58b = _0x2f608a, _0x274381, _0x5d2d52 = 0x0; for (var _0x30ddec of this[_0x14b58b(0x331)]()) { var _0x233ce8 = Game[_0x14b58b(0x32e)][_0x14b58b(0x242)]({ 'x': _0x30ddec[_0x14b58b(0x1ff)], 'z': _0x30ddec[_0x14b58b(0x255)] }), _0x3436de = _0x30ddec?.[_0x14b58b(0x23a)] == _0x14b58b(0x2f9) ? 0x64 : 0xa; !_0x233ce8 && ((_0x250959 || 0x0) >= _0x3436de && _0x3436de > _0x5d2d52) && (_0x5d2d52 = _0x3436de, _0x274381 = _0x30ddec); } if (_0x274381) return console[_0x14b58b(0x2db)](_0x14b58b(0x327) + _0x5d2d52 + _0x14b58b(0x2b4) + _0x250959 + _0x14b58b(0x223) + _0x274381[_0x14b58b(0x23a)]), console[_0x14b58b(0x2db)](_0x274381), _0x274381; console['log']('No\x20trade\x20depot\x20is\x20available\x20yet.'); } [_0x2f608a(0x208)](_0xd6d8e4) { var _0x58fe01 = _0x2f608a; _0x5c2449[_0x58fe01(0x238)](_0x5c2449[_0x58fe01(0x328)]['worldToScreen'](_0xd6d8e4[_0x58fe01(0x32c)][_0x58fe01(0x28e)])); } [_0x2f608a(0x1ed)]() { var _0x53ffa6 = _0x2f608a; for (var _0x551979 of this[_0x53ffa6(0x2ac)]()) { var _0x265901 = _0x551979[_0x53ffa6(0x33f)]['data'][_0x53ffa6(0x324)], _0x4032f0 = _0x5c2449[_0x53ffa6(0x24c)](_0x265901); if (!isNaN(+_0x4032f0)) { console[_0x53ffa6(0x2db)]('Checking\x20jimmy\x20' + _0x265901 + '\x20(' + _0x4032f0 + _0x53ffa6(0x1dd)); var _0x40a4c7 = +this['items'][_0x265901]?.[_0x53ffa6(0x210)] || 0x0; if (_0x4032f0 <= _0x40a4c7) _0x551979[_0x53ffa6(0x33f)][_0x53ffa6(0x215)][_0x53ffa6(0x343)] && (console[_0x53ffa6(0x2db)](_0x265901 + '\x20is\x20too\x20low,\x20stopping\x20related\x20neighbor\x20transports.'), _0x551979['logicObject'][_0x53ffa6(0x19b)](![]), !![]) || console[_0x53ffa6(0x2db)](_0x53ffa6(0x1a3)); else !_0x551979[_0x53ffa6(0x33f)][_0x53ffa6(0x215)][_0x53ffa6(0x343)] && (console['log'](_0x265901 + _0x53ffa6(0x19f)), _0x551979[_0x53ffa6(0x33f)][_0x53ffa6(0x19b)](!![]), !![]) || console[_0x53ffa6(0x2db)](_0x53ffa6(0x1c2)); } 0x4d; } } ['getItems'](_0x383d9d = ![]) { var _0x1723d3 = _0x2f608a; return Object[_0x1723d3(0x1f3)](this['items'])[_0x1723d3(0x27d)](_0x52d105 => ({ 'name': _0x52d105, 'value': this[_0x1723d3(0x2c2)][_0x52d105][_0x1723d3(0x197)]?.[_0x1723d3(0x2e3)] || 0x0, 'item': this[_0x1723d3(0x2c2)][_0x52d105] }))[_0x1723d3(0x2d6)](_0x2a6268 => _0x383d9d || !_0x2a6268[_0x1723d3(0x19c)]['disabled'])[_0x1723d3(0x1cd)]((_0x49fe5c, _0x312b60) => _0x312b60[_0x1723d3(0x1a5)] - _0x49fe5c[_0x1723d3(0x1a5)]); } *[_0x2f608a(0x2b5)]() { var _0x2cf436 = _0x2f608a; if (!_0x5c2449[_0x2cf436(0x300)]) return; this['processNeighborDeliveries'](); if (Math[_0x2cf436(0x283)]() > 0.25) return; _0x5c2449[_0x2cf436(0x313)](), _0x5c2449[_0x2cf436(0x258)](), _0x5c2449['checkAirDrop'](); if (this[_0x2cf436(0x26c)] > 0x0) { --this['waitCounter']; return; } var _0x1275fb = _0x5c2449['getCancelTradeButton'](); if (_0x1275fb && Date[_0x2cf436(0x31c)]() - this[_0x2cf436(0x240)] >= 0x7530) _0x1275fb['click'](); if (this['compassOpen']()) { console[_0x2cf436(0x2db)](_0x2cf436(0x326)); return; } this[_0x2cf436(0x286)](); if (_0x5c2449[_0x2cf436(0x21d)]() < 0x1) { console[_0x2cf436(0x2db)]('Cannot\x20sell:\x20Not\x20enough\x20gas!'); return; } if (!this[_0x2cf436(0x1d7)]() && this[_0x2cf436(0x1f9)]()) { console[_0x2cf436(0x2db)](_0x2cf436(0x26a)); return; } if (this[_0x2cf436(0x1e3)]) { this[_0x2cf436(0x1e3)] = ![]; debugger; } function _0x14943e(_0x9984b1, _0x1626dd) { var _0x56fd92 = _0x2cf436, _0x52019f = _0x5c2449['getGas'](), _0x356e67 = _0x1626dd['min'] || 0x0, _0xf44605 = _0x1626dd[_0x56fd92(0x28b)] || 0x0, _0x54d491 = Game[_0x56fd92(0x28d)] <= _0x5c2449[_0x56fd92(0x228)]() * 0x2; return _0x52019f > _0xf44605 && _0x9984b1 > 0x9 && (_0x54d491 || _0x9984b1 > _0x356e67); } for (var _0x5e5ff0 of this[_0x2cf436(0x32b)]()) { let _0x4c5c44 = _0x5e5ff0['item'], _0x158091 = _0x5e5ff0[_0x2cf436(0x1bd)]; var _0x47c3e0 = _0x5c2449[_0x2cf436(0x24c)](_0x158091); if (_0x14943e(_0x47c3e0, _0x4c5c44)) { var _0x172291 = this['findAvailableTrade'](_0x47c3e0); if (!_0x172291) { console[_0x2cf436(0x2db)]('Tried\x20to\x20sell\x20\x27' + _0x158091 + '\x27,\x20but\x20no\x20qualifying\x20trade\x20depot\x20found.'); continue; } console['log'](_0x2cf436(0x1e6) + _0x158091 + _0x2cf436(0x1b6) + _0x47c3e0 + _0x2cf436(0x1ab) + _0x4c5c44[_0x2cf436(0x28b)] + _0x2cf436(0x1dd)), yield this[_0x2cf436(0x208)](_0x172291); if (!this[_0x2cf436(0x2b2)]()) { console[_0x2cf436(0x2db)](_0x2cf436(0x1c8)); return; } yield this['openSellMenu'](); while (this[_0x2cf436(0x2f4)]()) { console['log'](_0x2cf436(0x201)); return; } var _0x2e8655 = this[_0x2cf436(0x30e)](_0x158091); if (!_0x2e8655) { console['log'](_0x2cf436(0x2f5) + _0x158091 + '\x27.'); return; } yield _0x2e8655[_0x2cf436(0x24d)](); var _0x2c33d4 = this[_0x2cf436(0x1e4)](); if (_0x2c33d4 > _0x5c2449[_0x2cf436(0x21d)]()) { console['log'](_0x2cf436(0x1a1)); return; } var _0x47c3e0 = _0x5c2449[_0x2cf436(0x24c)](_0x158091); if (_0x14943e(_0x47c3e0, _0x4c5c44)) yield this[_0x2cf436(0x277)](), yield console[_0x2cf436(0x2db)](_0x2cf436(0x29b) + _0x158091 + _0x2cf436(0x1db)), typeof _0xa9b332 != 'undefined' && _0xa9b332['current'] && (_0xa9b332['current'][_0x2cf436(0x211)][_0x158091] = [], _0xa9b332[_0x2cf436(0x1d8)]['avgTrends'][_0x158091] = 0x0); else console[_0x2cf436(0x2db)](_0x2cf436(0x2a8)); return; } } console[_0x2cf436(0x2db)](_0x2cf436(0x2b9)), _0x5c2449[_0x2cf436(0x23b)][_0x2cf436(0x2cf)] = ![], this[_0x2cf436(0x26c)] = 0x3; } [_0x2f608a(0x1b3)]() { var _0x427dcd = _0x2f608a; if (!this[_0x427dcd(0x265)]) { console[_0x427dcd(0x2db)]('Creating\x20new\x20Seller\x20config\x20section\x20...'); let _0x43dcd7 = document[_0x427dcd(0x1cf)]('div'), _0x2414d6 = [], _0x48f65d = document['createElement'](_0x427dcd(0x30d)); _0x48f65d[_0x427dcd(0x23a)] = _0x427dcd(0x1b1), _0x48f65d[_0x427dcd(0x2e0)] = _0x427dcd(0x2d9), _0x48f65d[_0x427dcd(0x1f8)][_0x427dcd(0x2d8)] = _0x427dcd(0x245), _0x48f65d['style'][_0x427dcd(0x259)] = _0x427dcd(0x270), _0x48f65d[_0x427dcd(0x1f8)]['fontSize'] = _0x427dcd(0x2c4), _0x48f65d[_0x427dcd(0x1f8)][_0x427dcd(0x333)] = _0x427dcd(0x2bb), _0x48f65d[_0x427dcd(0x213)] = _0x16b4df => _0x16b4df['stopPropagation'](), _0x48f65d[_0x427dcd(0x2f6)] = _0x6c66de => { var _0x1ea5a4 = _0x427dcd; _0x6c66de['stopPropagation'](); let _0x57ac08 = _0x48f65d[_0x1ea5a4(0x1a5)][_0x1ea5a4(0x305)]()['toUpperCase'](); for (var _0x96e2b3 of _0x2414d6) if (_0x96e2b3[_0x1ea5a4(0x1d0)]?.['toUpperCase']()[_0x1ea5a4(0x1b8)](_0x57ac08) >= 0x0) _0x96e2b3[_0x1ea5a4(0x1f8)]['display'] = ''; else _0x96e2b3[_0x1ea5a4(0x1f8)][_0x1ea5a4(0x2f1)] = _0x1ea5a4(0x310); }, _0x43dcd7[_0x427dcd(0x31f)](_0x48f65d); for (let _0x9e1735 of this[_0x427dcd(0x32b)](!![])) { let _0x5efd8c = _0x9e1735[_0x427dcd(0x1bd)], _0x199174 = _0x9e1735[_0x427dcd(0x19c)], _0x824ccd = _0x5efd8c[_0x427dcd(0x30c)](/_/g, '\x20'), _0x522aec = _0x5c2449[_0x427dcd(0x33e)]('<span\x20style=\x27font-weight:\x20bold\x27>' + _0x824ccd + '\x20(' + _0x9e1735[_0x427dcd(0x1a5)] + '\x20points\x20and\x20$' + _0x9e1735[_0x427dcd(0x19c)]['craftData']?.[_0x427dcd(0x298)] + _0x427dcd(0x1b2)), _0x5a0df2 = document['createElement'](_0x427dcd(0x1e8)); _0x5a0df2['innerHTML'] = _0x427dcd(0x262); let _0x1928ad = _0x5c2449[_0x427dcd(0x299)](!_0x199174[_0x427dcd(0x335)]); _0x1928ad[_0x427dcd(0x31b)] = _0x13d0a2 => { var _0x4a6937 = _0x427dcd; _0x199174['disabled'] = !_0x1928ad[_0x4a6937(0x2c6)], this[_0x4a6937(0x2da)](); }, _0x5a0df2[_0x427dcd(0x31f)](_0x1928ad), _0x5a0df2['append']('\u00a0'); for (let _0x3653f8 of [[_0x427dcd(0x28b), 'Min'], [_0x427dcd(0x341), _0x427dcd(0x22c)], [_0x427dcd(0x210), _0x427dcd(0x1e2)]]) { let _0x379eb6 = _0x3653f8[0x0], _0x2bcb52 = _0x3653f8[0x1]; _0x5a0df2[_0x427dcd(0x2c7)](_0x2bcb52 + ':\x20'); let _0x5470f6 = _0x5c2449[_0x427dcd(0x31d)](_0x199174[_0x379eb6] !== void 0x0 ? _0x199174[_0x379eb6] : ''); _0x5470f6[_0x427dcd(0x31b)] = _0x20e042 => { var _0x474721 = _0x427dcd; _0x20e042[_0x474721(0x1f1)](), _0x199174[_0x379eb6] = +_0x5470f6['value'] || 0x0, this[_0x474721(0x2da)](); }, _0x5a0df2[_0x427dcd(0x31f)](_0x5470f6), _0x5a0df2[_0x427dcd(0x2c7)]('\u00a0'); } _0x522aec[_0x427dcd(0x31f)](_0x5a0df2), _0x522aec['__ts_ext_config_title'] = _0x824ccd, _0x2414d6[_0x427dcd(0x1c0)](_0x522aec), _0x43dcd7[_0x427dcd(0x31f)](_0x522aec); } this['configSection'] = _0x5c2449[_0x427dcd(0x32d)](this, _0x427dcd(0x20b), _0x43dcd7); } else console['log'](_0x427dcd(0x1ef)); return this[_0x427dcd(0x265)]; } [_0x2f608a(0x2f3)]() { var _0x216715 = _0x2f608a; if (!this['started']) return this[_0x216715(0x212)] = !![], this[_0x216715(0x1f2)](), console[_0x216715(0x2db)]('Selling\x20started.'), !![]; return ![]; } [_0x2f608a(0x19d)]() { var _0x5bb135 = _0x2f608a; if (this[_0x5bb135(0x212)]) return this[_0x5bb135(0x212)] = ![], console[_0x5bb135(0x2db)]('Selling\x20stopped.'), !![]; return ![]; } } _0x3e30c6['Seller'] = _0x205553;; (function (_0x143d02) { var _0x5bc4c3 = _0x2f608a; _0x5c2449[_0x5bc4c3(0x329)]('Seller', _0x143d02); }(_0x205553 = _0x3e30c6[_0x2f608a(0x20b)] || (_0x3e30c6[_0x2f608a(0x20b)] = {}))); class _0x84df59 { constructor() { var _0x31b259 = _0x2f608a; this[_0x31b259(0x1a7)] = 0x5, this['_minWood'] = 0x2, this['processing'] = ![], this[_0x31b259(0x212)] = ![]; } [_0x2f608a(0x243)]() { var _0x1d5e09 = _0x2f608a; if (this[_0x1d5e09(0x212)]) { var _0x155a31 = _0x5c2449[_0x1d5e09(0x24c)]('Lumber') >= this[_0x1d5e09(0x1a7)]; if (this[_0x1d5e09(0x1ec)] === void 0x0 || this[_0x1d5e09(0x1ec)] != _0x155a31) { this['_lastLumberState'] = _0x155a31; if (_0x155a31) console[_0x1d5e09(0x2db)](_0x1d5e09(0x2ef)); else console[_0x1d5e09(0x2db)]('Lumber\x20is\x20getting\x20low,\x20turning\x20it\x20on\x20...'); for (var _0x562469 of _0x5c2449[_0x1d5e09(0x273)](_0x1d5e09(0x1fe))) if (_0x155a31) { if (_0x562469[_0x1d5e09(0x33f)][_0x1d5e09(0x215)][_0x1d5e09(0x324)] == _0x1d5e09(0x28f)) _0x562469[_0x1d5e09(0x33f)][_0x1d5e09(0x2fe)](_0x1d5e09(0x1e5)); } else { if (!_0x562469[_0x1d5e09(0x33f)][_0x1d5e09(0x215)][_0x1d5e09(0x324)] || _0x562469[_0x1d5e09(0x33f)]['data'][_0x1d5e09(0x324)] == _0x1d5e09(0x1e5)) _0x562469['logicObject'][_0x1d5e09(0x2fe)](_0x1d5e09(0x28f)); } } var _0x155a31 = _0x5c2449['getItemQuantity']('Wood') < this['_minWood']; if (this[_0x1d5e09(0x33a)] === void 0x0 || this[_0x1d5e09(0x33a)] != _0x155a31) { this[_0x1d5e09(0x33a)] = _0x155a31; if (_0x155a31) console['log'](_0x1d5e09(0x263)); else console[_0x1d5e09(0x2db)]('Wood\x20is\x20getting\x20higher,\x20turning\x20windmills\x20on\x20...'); for (var _0x562469 of _0x5c2449[_0x1d5e09(0x273)](_0x1d5e09(0x206))) if (_0x155a31) _0x562469['logicObject']['data'][_0x1d5e09(0x324)] != _0x1d5e09(0x1e5) && (_0x562469[_0x1d5e09(0x33f)]['prevCraft'] = _0x562469[_0x1d5e09(0x33f)][_0x1d5e09(0x215)][_0x1d5e09(0x324)], _0x562469['logicObject'][_0x1d5e09(0x2fe)](_0x1d5e09(0x1e5))); else { if (_0x562469[_0x1d5e09(0x33f)]['data']['craft'] == _0x1d5e09(0x1e5) && _0x562469['logicObject'][_0x1d5e09(0x19e)]) _0x562469[_0x1d5e09(0x33f)][_0x1d5e09(0x2fe)](_0x562469[_0x1d5e09(0x33f)][_0x1d5e09(0x19e)]); } } } } *[_0x2f608a(0x2b5)]() { var _0x5ee16a = _0x2f608a; if (!_0x5c2449[_0x5ee16a(0x300)] || this[_0x5ee16a(0x29d)]) return; this[_0x5ee16a(0x29d)] = !![]; try { this['_onAmmountChanged'](); } finally { this['processing'] = ![]; } } ['getConfig']() { var _0x257e33 = _0x2f608a; if (!this['configSection']) { var _0x112a15 = document['createElement'](_0x257e33(0x1e8)), _0x4733c6 = _0x5c2449[_0x257e33(0x33e)]('Max\x20Lumber'), _0x2e2941 = _0x5c2449[_0x257e33(0x31d)](this['_maxLumber']); _0x2e2941['onchange'] = _0x5e2089 => { var _0x17d9ed = _0x257e33; _0x5e2089['stopPropagation'](), this['_maxLumber'] = +_0x2e2941[_0x17d9ed(0x1a5)] || 0x0; }, _0x112a15[_0x257e33(0x31f)](_0x4733c6), _0x112a15[_0x257e33(0x31f)](_0x2e2941); } return this['configSection'] = _0x5c2449[_0x257e33(0x32d)](this, _0x257e33(0x20b), _0x112a15), this[_0x257e33(0x265)]; } [_0x2f608a(0x2f3)]() { var _0x2f9199 = _0x2f608a; if (!this[_0x2f9199(0x212)]) return this[_0x2f9199(0x212)] = !![], Game[_0x2f9199(0x27a)]['on'](_0x2f9199(0x1bc), this[_0x2f9199(0x1be)] || (this['__onAmmountChangedHandler'] = this[_0x2f9199(0x243)][_0x2f9199(0x1ad)](this))), this[_0x2f9199(0x243)](), console[_0x2f9199(0x2db)](_0x2f9199(0x2d1)), !![]; return ![]; } [_0x2f608a(0x19d)]() { var _0x5cf07b = _0x2f608a; if (this[_0x5cf07b(0x212)]) { this[_0x5cf07b(0x212)] = ![]; if (this[_0x5cf07b(0x1be)]) Game[_0x5cf07b(0x27a)]['off'](this[_0x5cf07b(0x1be)]); return console[_0x5cf07b(0x2db)](_0x5cf07b(0x233)), !![]; } return ![]; } } _0x3e30c6[_0x2f608a(0x25a)] = _0x84df59, function (_0x3e38ce) { _0x5c2449['register']('TownManager', _0x3e38ce); }(_0x84df59 = _0x3e30c6['TownManager'] || (_0x3e30c6['TownManager'] = {})); }(TownstarExtensions || (TownstarExtensions = {}))); function tryStart() { var _0x510ede = _0x2f80; if (typeof Game == _0x510ede(0x26d)) console[_0x510ede(0x232)]('You\x20are\x20not\x20in\x20the\x20correct\x20frame,\x20or\x20the\x20game\x20has\x20not\x20loaded\x20yet.\x20\x20You\x20must\x20select\x20the\x20correct\x20from\x20in\x20the\x20dropdown\x20at\x20the\x20top.\x20It\x20should\x20say\x20\x27townstar.sandbox-games.com\x27\x20or\x20similar\x20in\x20the\x20text.'), setTimeout(tryStart, 0x3e8); else !Game[_0x510ede(0x2ee)] || !Game[_0x510ede(0x32e)]?.[_0x510ede(0x297)] ? (console[_0x510ede(0x232)](_0x510ede(0x2f7)), setTimeout(tryStart, 0x3e8)) : (TSAPI = new Function(_0x510ede(0x27f))(), TownstarExtensions[_0x510ede(0x2f3)](), console[_0x510ede(0x2db)](_0x510ede(0x22e)), console[_0x510ede(0x2db)](_0x510ede(0x338) + Game['userId'] + _0x510ede(0x30a))); } setTimeout(tryStart, 0x3e8), function (_0x7a64f8) { var _0x2351ac = _0x2f80; _0x7a64f8['ts'] = () => Game[_0x2351ac(0x27a)][_0x2351ac(0x2a5)], _0x7a64f8['API'][_0x2351ac(0x2d5)] = function () { var _0x40cb93 = _0x2351ac; for (var _0x7fe437 in Game[_0x40cb93(0x2c3)]) if (_0x40cb93(0x2e9) in Game[_0x40cb93(0x2c3)][_0x7fe437]) Game[_0x40cb93(0x2c3)][_0x7fe437][_0x40cb93(0x2e9)] = _0x40cb93(0x1e5); }; var _0x3be018 = _0x7a64f8[_0x2351ac(0x2f3)]; _0x7a64f8['start'] = async function () { var _0x5005d5 = _0x2351ac; await _0x3be018[_0x5005d5(0x24b)](_0x7a64f8); }; }(TownstarExtensions || (TownstarExtensions = {})), eval('window[\'TownstarExtensions\'] = TownstarExtensions;');
